<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>واتساب جماعي - إرسال رسالة لأكثر من رقم</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet"/>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body { font-family: 'Cairo', sans-serif; background: linear-gradient(135deg, #0f2027, #203a43, #2c5364); color: #e0e0e0; min-height: 100vh; padding: 20px; display: flex; justify-content: center; align-items: center; }
    .container { background: rgba(255,255,255,0.07); backdrop-filter: blur(10px); border-radius: 20px; padding: 40px 30px; width: 100%; max-width: 600px; box-shadow: 0 15px 40px rgba(0,0,0,0.5); border: 1px solid rgba(255,255,255,0.12); }
    h1 { text-align: center; color: #25D366; margin-bottom: 35px; font-size: 2.2rem; text-shadow: 0 2px 10px rgba(37,211,102,0.4); }
    .form-group { margin-bottom: 28px; }
    label { display: block; margin-bottom: 10px; font-weight: 600; color: #d0d0d0; font-size: 1.1rem; }
    textarea { width: 100%; padding: 14px 16px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.18); background: rgba(255,255,255,0.06); color: white; font-size: 1.05rem; resize: vertical; min-height: 130px; font-family: 'Cairo', sans-serif; transition: all 0.3s; }
    textarea:focus { outline: none; border-color: #25D366; box-shadow: 0 0 0 3px rgba(37,211,102,0.25); background: rgba(255,255,255,0.1); }
    .btn { width: 100%; padding: 16px; background: linear-gradient(90deg, #25D366, #128C7E); color: white; border: none; border-radius: 12px; font-size: 1.3rem; font-weight: 600; cursor: pointer; transition: all 0.3s; box-shadow: 0 8px 25px rgba(37,211,102,0.35); }
    .btn:hover { transform: translateY(-3px); box-shadow: 0 12px 35px rgba(37,211,102,0.5); }
    .note, .info { text-align: center; margin-top: 25px; font-size: 0.95rem; color: #bbb; line-height: 1.7; }
    .note { color: #ffcc00; font-weight: 500; }
    .debug { margin-top: 20px; padding: 12px; background: rgba(0,200,0,0.2); border-radius: 8px; font-size: 0.9rem; color: #e0ffe0; direction: ltr; text-align: left; white-space: pre-wrap; font-family: monospace; }
  </style>
</head>
<body>

<div class="container">
  <h1><i class="fab fa-whatsapp"></i> واتساب جماعي</h1>

  <div class="form-group">
    <label>الأرقام (كل رقم في سطر):</label>
    <textarea id="numbers" placeholder="201001234567\n+201112233445\n01204414224" required></textarea>
  </div>

  <div class="form-group">
    <label>الرسالة:</label>
    <textarea id="message" placeholder="مرحبا! عندي عرض خاص..." required></textarea>
  </div>

  <button class="btn" onclick="sendMessages()">
    <i class="fab fa-whatsapp"></i> إرسال الرسائل الآن
  </button>

  <div class="note">
    • اكتب الأرقام بدون مسافات أو رموز إضافية قدر الإمكان<br>
    • الموقع هيظبط الرقم تلقائيًا (بدون +)
  </div>

  <div class="info">
    اضغط "إرسال" في كل تبويب يفتح.<br>
    لو مفيش تبويبات بتفتح: شغّل Pop-ups للموقع في إعدادات المتصفح.
  </div>

  <div id="debug" class="debug">Debug info will appear here...</div>
</div>

<script>
  function sendMessages() {
    const numbersText = document.getElementById('numbers').value.trim();
    const message = encodeURIComponent(document.getElementById('message').value.trim());
    const debugDiv = document.getElementById('debug');

    if (!numbersText || !message) {
      alert('املأ الأرقام والرسالة!');
      return;
    }

    let numbers = numbersText.split(/\n+/)
      .map(s => s.trim())
      .filter(s => s && /\d{9,}/.test(s))
      .map(s => {
        let digits = s.replace(/[^0-9]/g, '');
        if (digits.length === 10) digits = '20' + digits;
        if (digits.length === 11 && digits.startsWith('0')) digits = '20' + digits.substring(1);
        return digits;
      })
      .filter(d => d.length >= 10);

    // Debug نظيف وواضح
    let debugContent = `Found ${numbers.length} valid numbers (without +):\n`;
    debugContent += numbers.join('\n') || 'لا يوجد أرقام صالحة';
    debugContent += '\n\nSample correct URL (يجب أن يفتح واتساب مع الرقم):\n';
    if (numbers.length > 0) {
      debugContent += `https://wa.me/\( {numbers[0]}?text= \){message.substring(0, 50)}...`;
    } else {
      debugContent += 'لا يوجد رقم صالح لعرض المثال';
    }
    debugDiv.innerHTML = debugContent;

    if (numbers.length === 0) {
      alert('ما فيش أرقام صالحة بعد التنظيف!');
      return;
    }

    numbers.forEach((num, index) => {
      setTimeout(() => {
        const url = `https://wa.me/\( {num}?text= \){message}`;
        const link = document.createElement('a');
        link.href = url;
        link.target = '_blank';
        link.rel = 'noopener noreferrer';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
      }, index * 3000);
    });

    alert(`جاري فتح ${numbers.length} تبويب...\nاضغط "إرسال" في كل واحد\nشوف الـ debug تحت: الرابط لازم يكون صحيح`);
  }
</script>
</body>
</html>
